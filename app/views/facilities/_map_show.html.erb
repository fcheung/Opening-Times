<% @onload = "initialize();" %>
<% content_for :head do -%>
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=<%= GOOGLE_MAPS_API_KEY %>" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var map = null;
var geocoder = null;

var center = new GLatLng(<%= @facility.lat %>,<%= @facility.lng %>);
var marker = new GMarker(center);

function initialize() {
  if (GBrowserIsCompatible()) {
    map = new GMap2(document.getElementById("map_canvas"));
    geocoder = new GClientGeocoder();

    map.addControl(new GLargeMapControl());
    map.addControl(new GMenuMapTypeControl());

    map.removeMapType(G_SATELLITE_MAP);
    var mapControl = new GMapTypeControl();
    map.addControl(mapControl);

  	map.setCenter(center, 16);
    marker.setLatLng(center)
    map.addOverlay(marker);
    map.openInfoWindowHtml(center, "<strong><%=h @facility.name %><\/strong><br \/><%= comma_to_br(h(@facility.address)).gsub('/','\/') %>, <%= h(@facility.postcode) %>", {pixelOffset: new
GSize(0,-22)});
  }
}
/* ]]> */
</script>
<% end -%>
<div id="map_canvas" style="border: 1px solid black; height: 360px;"></div>
